<mat-form-field [formGroup]="filterForm" *ngIf="filterable">
  <mat-label>Search</mat-label>
  <input matInput formControlName="filterValue" placeholder="Thông tin tìm kiếm">
</mat-form-field>
<div class="">
  <table mat-table [dataSource]="allInOne ? dataSource : data" 
  matSort (matSortChange)="sortChange($event)"
  cdkDropList
  cdkDropListOrientation="horizontal"
  (cdkDropListDropped)="drop($event)">

    <!-- Checkbox Column -->
    <ng-container matColumnDef="selector">
      <th mat-header-cell cdkDrag *matHeaderCellDef class="checkbox-col">
        <mat-checkbox
          (change)="$event ? masterToggle() : null" 
          [checked]="selection.hasValue() && isAllSelected()"
          [indeterminate]="selection.hasValue() && !isAllSelected()" 
          [aria-label]="checkboxLabel()"
          [disabled]="allInOne ? dataSource.filteredData.length === 0 : data.length === 0">
        </mat-checkbox>
      </th>
      <td mat-cell *matCellDef="let row" class="checkbox-col">
        <mat-checkbox 
          (click)="$event.stopPropagation()" 
          (change)="rowCheck($event, row)"
          [checked]="selection.isSelected(selectKey ? row[selectKey] : row)" 
          [aria-label]="checkboxLabel(row)">
        </mat-checkbox>
      </td>
      <ng-container *ngIf="hasFooter">
        <td mat-footer-cell *matFooterCellDef class="checkbox-col"></td>
      </ng-container>
    </ng-container>

    <!-- Column Setup -->
    <ng-container [matColumnDef]="getSelectorName(column.selector)" *ngFor="let column of columnsSetting">
      <ng-container *ngIf="column.sortable">
        <th mat-header-cell cdkDrag *matHeaderCellDef mat-sort-header class="mat-column" [class]="column.className">
          {{ column.name }}
        </th>
      </ng-container>
      <ng-container *ngIf="!column.sortable">
        <th mat-header-cell cdkDrag *matHeaderCellDef class="mat-column" [class]="column.className">
          {{ column.name }}
        </th>
      </ng-container>
      <ng-container [ngSwitch]="column.type">

        <!-- CASE TEXT *DEFAULT* -->
        <ng-container *ngSwitchCase="tableColType.TEXT">
          <td mat-cell *matCellDef="let row" class="mat-column" [class]="column.className"> {{colDisplayValue(row, column.selector)}} </td>
        </ng-container>

        <!-- CASE DATE -->
        <ng-container *ngSwitchCase="tableColType.DATE">
          <td mat-cell *matCellDef="let row" class="mat-column" [class]="column.className"> {{colDisplayValue(row, column.selector) | date:'dd-MM-yyyy'}} </td>
        </ng-container>

        <!-- CASE DATETIME -->
        <ng-container *ngSwitchCase="tableColType.DATE_TIME">
          <td mat-cell *matCellDef="let row" class="mat-column" [class]="column.className"> {{colDisplayValue(row, column.selector) | date:'dd-MM-yyyy hh:mm:ss'}} </td>
        </ng-container>

        <!-- CASE MONEY -->
        <ng-container *ngSwitchCase="tableColType.MONEY">
          <td mat-cell *matCellDef="let row" class="mat-column" [class]="column.className"> {{colDisplayValue(row, column.selector) | number: '1.0-2'}} </td>
        </ng-container>

        <!-- CASE HYPERLINK -->
        <ng-container *ngSwitchCase="tableColType.HYPERLINK">
          <td mat-cell *matCellDef="let row" class="mat-column" [class]="column.className"><a class="hyperlink" (click)="hyperLinkClicked(row, column)">
              {{colDisplayValue(row, column.selector)}} </a></td>
        </ng-container>

        <!-- CASE ACTIVE -->
        <ng-container *ngSwitchCase="tableColType.ACTIVE">
          <td mat-cell *matCellDef="let row" class="mat-column" 
            [class]="column.className"
            [ngClass]="isActive(colDisplayValue(row, column.selector)) === 'done' ? 'status-label-active' : 'status-label-inactive'">
            <mat-icon class="font-w-600">{{ isActive(colDisplayValue(row, column.selector)) }}</mat-icon>
          </td>
        </ng-container>

        <!-- CASE HYPERLINK -->
        <ng-container *ngSwitchCase="tableColType.EVENT">
          <td mat-cell *matCellDef="let row" class="mat-column" [class]="column.className">
            <ng-container *ngFor="let event of column.events">
              <ng-container *ngIf="checkEventCondition(event, row)">
                <span (click)="eventColClicked(row, event)" [matTooltip]="event.tooltip">
                  <mat-icon [color]="event.color" class="c-pointer">{{event.icon}}</mat-icon> {{event.name}}
                </span>
              </ng-container>
            </ng-container>
          </td>
        </ng-container>

      </ng-container>

      <!-- TABLE FOOTER -->
      <ng-container *ngIf="hasFooter">
        <ng-container [ngSwitch]="column.footerType">

          <!-- CASE TEXT *DEFAULT* -->
          <ng-container *ngSwitchDefault>
            <td mat-footer-cell *matFooterCellDef="let row" class="mat-column" [class]="column.className"> {{column.footer}} </td>
          </ng-container>

          <!-- CASE DATE -->
          <ng-container *ngSwitchCase="tableColType.DATE">
            <td mat-footer-cell *matFooterCellDef="let row" class="mat-column" [class]="column.className"> {{column.footer | date:'dd-MM-yyyy'}} </td>
          </ng-container>
  
          <!-- CASE DATETIME -->
          <ng-container *ngSwitchCase="tableColType.DATE_TIME">
            <td mat-footer-cell *matFooterCellDef="let row" class="mat-column" [class]="column.className"> {{column.footer | date:'dd-MM-yyyy hh:mm:ss'}} </td>
          </ng-container>
  
          <!-- CASE MONEY -->
          <ng-container *ngSwitchCase="tableColType.MONEY">
            <td mat-footer-cell *matFooterCellDef="let row" class="mat-column" [class]="column.className"> {{column.footer | number: '1.0-2'}} </td>
          </ng-container>

        </ng-container>
      </ng-container>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
    <ng-container *ngIf="hasFooter"><tr mat-footer-row *matFooterRowDef="displayedColumns"></tr></ng-container>

  </table>

  <!-- Row shown when there is no matching data. (All In One data) -->
  <div class="mat-row ta-c pt-1r form-error-message font-w-500 font-style-italic font-sz-16"
    *ngIf="(dataSource.data.length === 0 || dataSource.filteredData.length === 0) && allInOne">
    <span class="" *ngIf="filterFormControl.value" colspan="4">No data matching the filter
      "{{filterFormControl.value}}"</span>
    <span class="" *ngIf="!filterFormControl.value" colspan="4">No data at the moment</span>
  </div>

  <!-- Row shown when there is no matching data. (Server-side data) -->
  <div class="mat-row ta-c pt-1r form-error-message font-w-500 font-style-italic font-sz-16"
    *ngIf="data.length === 0 && !allInOne">
    <span class="" colspan="4">No data at the moment</span>
  </div>

  <mat-paginator *ngIf="showPaging" [pageSizeOptions]="[5, 10, 25, 100]" [length]="totalElement" (page)="pageChange($event)">
  </mat-paginator>
</div>